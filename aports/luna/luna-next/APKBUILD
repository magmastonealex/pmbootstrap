pkgname=luna-next
pkgver=9999
pkgrel=2
pkgdesc="The new webOS UI of the webOS ports project."
arch="all"
url="http://webos-ports.org"
license="GPL-3.0+"
depends="luna-sysmgr-common"
makedepends="extra-cmake-modules cmake-modules-webos qt5-qtbase-dev qt5-qtdeclarative-dev wayland-dev qt5-qtwayland-dev qt5-qtwayland luna-sysmgr-common"
source="$pkgname-$pkgver.zip::https://github.com/webOS-ports/luna-next/archive/428a337f922691b00534f041193ee7dca8defcc2.zip
	remove-systemd-harddep.patch compile.patch"

prepare() {
	mkdir -p "$srcdir"/build
	cd "$srcdir"/$pkgname-428a337f922691b00534f041193ee7dca8defcc2
	patch -p1 < "$srcdir"/remove-systemd-harddep.patch
	patch -p1 < "$srcdir"/compile.patch
}

build() {
	cd "$srcdir"/build
	cmake "$srcdir"/$pkgname-428a337f922691b00534f041193ee7dca8defcc2 \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DKDE_INSTALL_LIBDIR=lib \
		-DKDE_INSTALL_LIBEXECDIR=lib \
		-DWEBOS_INSTALL_ROOT=/
	make
}

package() {
	cd "$srcdir"/build
	make DESTDIR="$pkgdir" install
}
sha512sums="449fdce96c6556666d8c4dcf5837b2cd99109cacc78d8ce5559913f80487db7934792ec1d15eda1ebe349e68d51b75b36f0e0859c4571c93691c9952eca70921  luna-next-9999.zip
f6dc58db48bdd1ec4126245aaeb3cf364dfb761cf0aae172ff19eda885fe0601c249fcfc5e89c1cbfb91e857d5c57bac24495bab62a4c03dff7711e7dad2a9f8  remove-systemd-harddep.patch
955dafa7739b24fb08d1a8558c3668a53d0f7b2d8f6db92d6ed25bff416a12b6c2c6e1c0d3087ad8cb922dfa99e5b5d4c65126f9096f5543bc0f8550d8547b90  compile.patch"
