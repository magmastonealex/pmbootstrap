pkgname=librolegen
pkgver=9999
pkgrel=1
pkgdesc="librolegen dynamically generates webOS system bus role files for webOS Javascript services"
arch="all"
url="http://webos-ports.org"
license="GPL-3.0+"
depends=""
makedepends="cmake-modules-webos"
source="$pkgname-$pkgver-$pkgrel.zip::https://github.com/webOS-ports/librolegen/archive/b293a3f8b05f83b36b1b673c4e7dd1c18bfcf768.zip
	fix-fexists.patch"
subpackages="$pkgname-dev"
options="!check"

prepare() {
	mkdir -p "$srcdir"/build
	cd "$srcdir"/$pkgname-b293a3f8b05f83b36b1b673c4e7dd1c18bfcf768
	patch -p1 < "$srcdir"/fix-fexists.patch
}

build() {
	cd "$srcdir"/build
	cmake "$srcdir"/$pkgname-b293a3f8b05f83b36b1b673c4e7dd1c18bfcf768 \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DWEBOS_INSTALL_ROOT=/
	make
}

package() {
	cd "$srcdir"/build
	make DESTDIR="$pkgdir" install
}
sha512sums="b074f69b2264bb692ea428b270fe24381a356bcab108df2c136b3c4c913a85e2be3d903dca3f2f35081b4b3ec8032b7f1d3a76d5bc52cbd9828c05c0dc6d1b07  librolegen-9999-1.zip
4aa60250ef7d01d3574fccf1427a399839d984e710782ad2753fbbbbfb5cfb652839be15a16e7b9ef11d595ecfad774ef0aed526413094694b0a5dd61969184c  fix-fexists.patch"
